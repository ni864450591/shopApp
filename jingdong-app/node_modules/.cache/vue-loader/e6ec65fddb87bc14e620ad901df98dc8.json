{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\src\\views\\orderConfigmation\\OrderBtn.vue?vue&type=template&id=1d9efcbf&scoped=true","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\src\\views\\orderConfigmation\\OrderBtn.vue","mtime":1620542977376},{"path":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1616796459000},{"path":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1616796459000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogICAgPGRpdiBjbGFzcz0ib3JkZXIiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJvcmRlcl9fcHJpY2UiPuWunuS7mOmHkeminSA8Yj7vv6V7e2NhY3VsYXRpb25zLnByaWNlfX08L2I+PC9kaXY+DQogICAgICAgIDxkaXYgY2xhc3M9Im9yZGVyX19idG4iIEBjbGljaz0naGFuZGxlU2hvd0NvbmZpcm0nPuaPkOS6pOiuouWNlTwvZGl2Pg0KICAgIDwvZGl2Pg0KICAgIDwhLS0g5by55Ye65piv5ZCm56Gu6K6k6K6i5Y2VIC0tPg0KICAgIDxkaXYNCiAgICBjbGFzcz0ibWFzayINCiAgICB2LXNob3c9J3Nob3dDb25maXJtJw0KICAgIEBjbGljaz0naGFuZGxlU2hvd0NvbmZpcm0nDQogICAgPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtYXNrX19jb250ZW50IiBAY2xpY2suc3RvcD4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1hc2tfX2NvbnRlbnRfX3RpdGxlIj7noa7orqTopoHnprvlvIDmlLbpk7blj7DvvJ88L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1hc2tfX2NvbnRlbnRfX2Rlc2MiPuivt+WwveW/q+WujOaIkOaUr+S7mO+8jOWQpuWImeWwhuiiq+WPlua2iDwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWFza19fY29udGVudF9fYnRucyI+DQogICAgICAgICAgICAgICAgPGRpdg0KICAgICAgICAgICAgICAgIGNsYXNzPSJtYXNrX19jb250ZW50X19idG4gbWFza19fY29udGVudF9fYnRuLS1maXJzdCINCiAgICAgICAgICAgICAgICAgQGNsaWNrPSIoKT0+eyBoYW5kbGVDYW5jZWxPcmRlcih0cnVlKSB9Ig0KICAgICAgICAgICAgICAgID7lj5bmtojorqLljZU8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2DQogICAgICAgICAgICAgICAgY2xhc3M9Im1hc2tfX2NvbnRlbnRfX2J0biBtYXNrX19jb250ZW50X19idG4tLWxhc3QiDQogICAgICAgICAgICAgICAgQGNsaWNrPSIoKT0+eyBoYW5kbGVDYW5jZWxPcmRlcihmYWxzZSkgfSINCiAgICAgICAgICAgICAgICA+56Gu6K6k5pSv5LuYPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQo="},{"version":3,"sources":["C:\\Users\\Administrator\\Desktop\\jingDong\\jingdong\\src\\views\\orderConfigmation\\OrderBtn.vue"],"names":[],"mappings":";IACI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACd,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAChE,CAAC,CAAC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACzB;QACI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAClC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAChD,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACpD,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC5B,CAAC,CAAC,CAAC;gBACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;iBAClD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;gBACxC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACV,CAAC,CAAC,CAAC;gBACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;gBACxC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACd,CAAC,CAAC,CAAC,CAAC,CAAC;QACT,CAAC,CAAC,CAAC,CAAC,CAAC;IACT,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Users/Administrator/Desktop/jingDong/jingdong/src/views/orderConfigmation/OrderBtn.vue","sourceRoot":"","sourcesContent":["<template>\r\n    <div class=\"order\">\r\n        <div class=\"order__price\">实付金额 <b>￥{{caculations.price}}</b></div>\r\n        <div class=\"order__btn\" @click='handleShowConfirm'>提交订单</div>\r\n    </div>\r\n    <!-- 弹出是否确认订单 -->\r\n    <div\r\n    class=\"mask\"\r\n    v-show='showConfirm'\r\n    @click='handleShowConfirm'\r\n    >\r\n        <div class=\"mask__content\" @click.stop>\r\n            <div class=\"mask__content__title\">确认要离开收银台？</div>\r\n            <div class=\"mask__content__desc\">请尽快完成支付，否则将被取消</div>\r\n            <div class=\"mask__content__btns\">\r\n                <div\r\n                class=\"mask__content__btn mask__content__btn--first\"\r\n                 @click=\"()=>{ handleCancelOrder(true) }\"\r\n                >取消订单</div>\r\n                <div\r\n                class=\"mask__content__btn mask__content__btn--last\"\r\n                @click=\"()=>{ handleCancelOrder(false) }\"\r\n                >确认支付</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useCommonCartEffect } from '../../effects/cartEffects'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { post } from '../../utils/request'\r\nimport { useStore } from 'vuex'\r\nimport { ref } from 'vue'\r\n\r\n//  提交订单按钮的事件逻辑\r\n//  遮罩层的显示与否\r\nconst submitEffect = () => {\r\n  const showConfirm = ref(false)\r\n  const handleShowConfirm = () => { showConfirm.value = !showConfirm.value }\r\n  return { showConfirm, handleShowConfirm }\r\n}\r\n\r\n// 确认支付按钮和取消订单的事件逻辑\r\n//  从购物车根据不同商铺id获取对应的数据：创建订单\r\n//  再将数据发送到后端，后端会返回一个支付成功或失败的标志\r\nconst confirmEffect = (shopId) => {\r\n  const router = useRouter()\r\n  const store = useStore()\r\n  //  创建订单需要的API接口格式：最主要是拼接出这个请求体\r\n  // {\r\n  //   addressId: '收货地址的id',   //为了可以找到对应地址并复制\r\n  //   shopId: '商店的id',         //为了找到对应商品\r\n  //   shopNane: '商店的名称',\r\n  //   isCanceled: false, //订单是否被取消\r\n  //   products:[{\r\n  //       _id: '商品的id',\r\n  //       num: 3 //购买数量\r\n  //   }, {\r\n  //       _id: '商品的id',     //这里也成了引用\r\n  //       num: 3 //购买数量\r\n  //   }]\r\n  //  }\r\n  //  商铺名和商品列表直接传入shopId获取即可\r\n  const { shopName, productList } = useCommonCartEffect(shopId)\r\n  const handleCancelOrder = async (isCanceled) => {\r\n    try {\r\n      const products = []\r\n      //  订单的商品列表中的商品id和商品数量\r\n      for (const key in productList.value) {\r\n        const product = productList.value[key]\r\n        products.push({ _id: product._id, num: product.count })\r\n      }\r\n      //  这里的修改收货地址还没能实现\r\n      //  然后发送给后端，然后端创建订单数据\r\n      const result = await post('api/order', {\r\n        addressId: '608e34e85ebab2289cdba76d',\r\n        shopId,\r\n        shopName: shopName.value,\r\n        isCanceled,\r\n        products\r\n      })\r\n      if (result.errno === 0) {\r\n        store.commit('clearCartProduct', { shopId })\r\n        router.push({ name: 'OrderList' })\r\n      } else {\r\n      // 提示支付失败\r\n      }\r\n    } catch (e) {}\r\n  }\r\n  return { handleCancelOrder }\r\n}\r\nexport default {\r\n  name: 'OrderBtn',\r\n  setup () {\r\n    const route = useRoute()\r\n    const shopId = route.params.id\r\n    const { caculations } = useCommonCartEffect(shopId)\r\n    const { showConfirm, handleShowConfirm } = submitEffect()\r\n    const { handleCancelOrder } = confirmEffect(shopId)\r\n    return { caculations, handleCancelOrder, showConfirm, handleShowConfirm }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../../style/viriables.scss';\r\n.order{\r\n    display: flex;\r\n    line-height: .49rem;\r\n    background: $bgColor;\r\n    position: fixed;\r\n    bottom:0;\r\n    left:0;\r\n    right:0;\r\n    &__price{\r\n        flex:1;\r\n        text-indent:.24rem;\r\n        font-size:.14rem;\r\n        color:$content-fontcolor;\r\n    }\r\n    &__btn{\r\n        width:.98rem;\r\n        background:#4FB0F9;\r\n        color:$bgColor;\r\n        text-align: center;\r\n        font-size:.14rem;\r\n    }\r\n}\r\n.mask{\r\n    position:absolute;\r\n    left:0;\r\n    right:0;\r\n    bottom:0;\r\n    top:0;\r\n    background: rgba(0,0,0,0.50);\r\n    z-index:1;\r\n    &__content{\r\n        width:3rem;\r\n        height:1.58rem;\r\n        background: #fff;\r\n        position:absolute;\r\n        top:50%;\r\n        left:50%;\r\n        transform: translate(-50%,-50%);\r\n        border-radius: .04rem;\r\n        text-align: center;\r\n        &__title{\r\n            font-size:.18rem;\r\n            color: #333333;\r\n            margin:.24rem 0 .08rem 0;\r\n            line-height: .26rem;\r\n        }\r\n        &__desc{\r\n            font-size: .14rem;\r\n            color: #666666;\r\n            line-height: .2rem;\r\n            margin-bottom: .24rem;\r\n        }\r\n        &__btns{\r\n            margin:0 .58rem;\r\n            display: flex;\r\n        }\r\n        &__btn{\r\n              flex:1;\r\n              width:.8rem;\r\n              line-height: .32rem;\r\n              border-radius: .16rem;\r\n              font-size:.14rem;\r\n              border: .01rem solid #4FB0F9;\r\n              color:#0091FF;\r\n            &--first{\r\n                margin-right:.24rem;\r\n            }\r\n            &--first:hover,\r\n            &--last:hover{\r\n                color:#fff;\r\n                background: #4FB0F9;\r\n            }\r\n          }\r\n    }\r\n}\r\n</style>\r\n"]}]}